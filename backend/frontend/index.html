<!DOCTYPE html>
<html>
<head>
  <title>Smart Waste Complaint</title>
  <style>
    body {
      font-family: Arial;
      background: #eef2f5;
      display:flex;
      justify-content:center;
      align-items:center;
      min-height:100vh;
    }
    .container {
      background:white;
      padding:40px;
      border-radius:12px;
      width:400px;
      box-shadow:0 8px 20px rgba(0,0,0,0.15);
    }
    h2 { text-align:center; color:#2c7be5; margin-bottom:20px; }
    input, textarea, button { width:100%; padding:12px; margin-top:12px; border-radius:8px; border:1px solid #ccc; font-size:14px; }
    textarea { resize:none; }
    button { background:#2c7be5; color:white; border:none; cursor:pointer; font-weight:600; transition:0.3s; }
    button:hover { background:#1a5bb8; }
    label { font-weight:600; margin-top:10px; display:block; }
    .admin-btn { background:#28a745; margin-bottom:15px; }-
    .admin-btn:hover { background:#1e7e34; }
  </style>
</head>
<body>

<div class="container">
  <button class="admin-btn" onclick="goAdmin()">Go to Admin Portal</button>
  <h2>Submit Complaint</h2>
  <label>City</label>
  <input type="text" id="city" placeholder="Enter city">
  <label>Area</label>
  <input type="text" id="area" placeholder="Enter area">
  <label>Garbage Type</label>
  <input type="text" id="category" placeholder="Wet / Dry">
  <label>Description</label>
  <textarea id="description" placeholder="Describe the problem" rows="4"></textarea>
  <label>Upload Photo</label>
  <input type="file" id="image" accept="image/*">
  <button onclick="submitComplaint()">Submit Complaint</button>
</div>

<script>
function goAdmin(){
  window.location.href = "admin.html";
}

async function submitComplaint(){
  const city = document.getElementById("city").value.trim();
  const area = document.getElementById("area").value.trim();
  const category = document.getElementById("category").value.trim();
  const description = document.getElementById("description").value.trim();
  const imageFile = document.getElementById("image").files[0];

  if(!city || !area || !category || !description){
    alert("Please fill all fields!");
    return;
  }

  const formData = new FormData();
  formData.append("city", city);
  formData.append("area", area);
  formData.append("category", category);
  formData.append("description", description);
  if(imageFile) formData.append("image", imageFile);

  try{
    const res = await fetch("http://localhost:3000/api/complaints", { method:"POST", body: formData });
    const data = await res.json();
    alert(data.message);
    // Clear form
    document.getElementById("city").value="";
    document.getElementById("area").value="";
    document.getElementById("category").value="";
    document.getElementById("description").value="";
    document.getElementById("image").value="";
  }catch(err){
    console.error(err);
    alert("Error submitting complaint. Make sure backend and MongoDB are running.");
  }
}
</script>

</body>
</html>
